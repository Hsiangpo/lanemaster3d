# 产品需求文档：LaneMaster3D

**版本**：1.0  
**日期**：2026-02-17  
**定位**：论文导向的3D车道线检测项目（先打分，再双轨投稿）

---

## 1. 目标与背景

本项目目标是在`OpenLane v1.2`上构建一个新方法，吸收`PersFormer`与`公开基线`优点，同时引入两者都没有的创新机制，用于支撑高水平论文投稿。

硬目标分两层：

1. 指标目标：`F1 > 62.9`（相机only主设置）  
2. 论文目标：双轨并行产出
   - 顶会轨：CVPR/ICCV/ECCV风格
   - 期刊轨：可扩展为Q1期刊版本

---

## 2. 成功标准

### 2.1 主指标

- OpenLane v1.2 验证集：`F1 > 62.9`
- `Cate Acc >= 93.0`
- `x/z close/far`误差不劣于对标方法同量级配置

### 2.2 工程标准

- 纯终端可运行训练/评测/恢复流程
- 可复现实验（固定配置、种子、日志、权重）
- 三次独立训练结果波动可解释

### 2.3 论文标准

- 至少两个独立创新点，且有完整消融支持
- 贡献链条闭合：设计动机 -> 模块机制 -> 指标收益 -> 场景分析
- 失败案例分析与鲁棒性分析齐全

---

## 3. 核心创新设计

### 创新点A：GCA（Geometry Consistency Adapter）

- 在锚点回归流程中引入几何一致性适配器
- 将语义特征与几何特征做可学习门控融合
- 目标：降低远距和高曲率场景误差

### 创新点B：GCS（Geometry Consistency Self-supervision）

- 引入几何循环一致性自监督损失
- 对`前向投影 -> 反向重投影`误差进行约束
- 目标：提升训练稳定性与跨场景泛化

---

## 4. 范围定义

### In Scope

- 单目3D车道线检测
- OpenLane v1.2主赛道
- 复现基线 + 创新模块集成 + 冲榜优化
- 双轨论文素材沉淀

### Out of Scope（当前阶段）

- LiDAR融合
- 端侧部署优化（量化、TensorRT深度压缩）
- 跨多数据集联合训练

---

## 5. 用户故事

1. 作为研究者，我希望通过终端一键启动训练，避免手工UI操作。  
2. 作为研究者，我希望实验结果可复现，便于论文撰写和审稿回复。  
3. 作为研究者，我希望创新点可量化验证，不只是工程调参收益。  

---

## 6. 功能需求

1. 训练入口：`tools/train.py`
2. 评测入口：`tools/eval.py`
3. 推理入口：`tools/infer.py`
4. 运行脚本：`scripts/train_dist.sh`、`scripts/eval_dist.sh`、`scripts/resume.sh`
5. 配置管理：`configs/openlane/r50_960x720.py`
6. 创新模块：
   - `lanemaster3d/models/geometry/gca.py`
   - `lanemaster3d/models/losses/gcs.py`

---

## 7. 非功能需求

- 全链路终端化执行（SSH + tmux）
- 训练日志持久化（tee到logs目录）
- 代码结构可维护（函数短小、模块边界清晰）

---

## 8. 评测与实验要求

1. 主结果表：与PersFormer/公开基线系对比  
2. 消融表：
   - 去掉GCA
   - 去掉GCS
   - 两者都去掉
3. 场景切片：夜间、弯道、远距、遮挡  
4. 统计稳健：3个随机种子

---

## 9. 里程碑

- M1：基线工程流跑通
- M2：GCA集成并验证收益
- M3：GCS集成并完成联合训练
- M4：超越`F1 62.9`
- M5：双轨论文素材完备，进入成文阶段

---

## 10. 风险与预案

1. 数据版本不一致 -> 固定OpenLane v1.2并记录版本信息  
2. 多卡训练不稳定 -> 先单卡冒烟，再双卡长训  
3. 分数波动大 -> 固定seed并做三次复验  
4. 创新收益不稳定 -> 保留回退路径和对照实验  


